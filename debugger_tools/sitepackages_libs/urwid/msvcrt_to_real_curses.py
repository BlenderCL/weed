# Dictionary to map keypress in msvcrt
# to curses representation

msvcrt_curses = {
    # First Group, only keypress 
    # (without [shft], [ctrl] or [alt])
    
    # [FUNCTION] keys   
    b'\x1b':('esc',27),
    (b'\x00', b';'):('f1',265), (b'\x00', b'<'):('f2',266), 
    (b'\x00', b'='):('f3',267), (b'\x00', b'>'):('f4',268), 
    (b'\x00', b'?'):('f5',269), (b'\x00', b'@'):('f6',270),
    (b'\x00', b'A'):('f7',271), (b'\x00', b'B'):('f8',272), 
    (b'\x00', b'C'):('f9',273), (b'\x00', b'D'):('f10',274), 
    (b'\xe0', b'\x85'):('f11',275), (b'\xe0', b'\x86'):('f12',276),
    
    # [insert] [delete]
    (b'\xe0', b'R'):('insert',331), (b'\xe0', b'S'):('delete',330),
    
    # [home] [page up] [page down] [end] 
    # [enter] [backspace]
    (b'\xe0', b'G'):('home',262), (b'\xe0', b'I'):('page up',339),
    (b'\xe0', b'Q'):('page down',338), (b'\xe0', b'O'):('end',358),
     b'\r':('enter',13), b'\x08':('backspace',8),
    
    # [NUMBER] keys
    b'|':('|',124),
    b'1':('1',49), b'2':('2',50), b'3':('3',51),
    b'4':('4',52), b'5':('5',53), b'6':('6',54),
    b'7':('7',55), b'8':('8',56), b'9':('9',57),
    b'0':('0',48), b"'":("'",39), b'\xa8':('?',168),
    
    # [q - p] keys 
    b'\t':('tab',9),
    b'q':('q',113), b'w':('w',119), b'e':('e',101),
    b'r':('r',114), b't':('t',116), b'y':('y',121),
    b'u':('u',117), b'i':('i',105), b'o':('o',111),
    b'p':('p',112), b'+':('+',43),
    
    # [a - l] keys
    b'a':('a',97), b's':('s',115), b'd':('d',100),
    b'f':('f',102), b'g':('g',103), b'h':('h',104),
    b'j':('j',106), b'k':('k',107), b'l':('l',108),
    b'\xa4':('?',164), b'{':('{',123), b'}':('}',125),
    
    # [z - m] keys
    b'<':('<',60), b'z':('z',122), b'x':('x',120),
    b'c':('c',99), b'v':('v',118), b'b':('b',98),
    b'n':('n',110), b'm':('m',109), b',':(',',44),
    b'.':('.',46), b'-':('-',45),
    
    # [space] [up] [left] [down] [right] 
    b' ':(' ',32),
    (b'\xe0', b'H'):('up',259), (b'\xe0', b'K'):('left',260),
    (b'\xe0', b'P'):('down',258), (b'\xe0', b'M'):('right',261),
    
    #   / * - keys
    # 7 8 9  
    # 4 5 6
    # 1 2 3 
    # 0   .
    # + enter
    # b'/':('<458>',458), b'*':('<463>',463), 45:('<464>',464),
    # b'7':('7',55), b'8':('8',56), b'9':('9',57),
    # b'4':('4',52), b'5':('5',53), b'6':('6',54),
    # b'1':('1',49), b'2':('2',50), b'3':('3',51),
    # b'0':('0',48), b'.':('.',46),
    # b'+':('<465>',465), b'\r':('<459>',459),
    
                  
    # Second Group
    # [shft] + keypress
    
    # [FUNCTION] keys   
    (b'\x00', b'T'):('shift f1',277), (b'\x00', b'U'):('shift f2',278), 
    (b'\x00', b'V'):('shift f3',279), (b'\x00', b'W'):('shift f4',280), 
    (b'\x00', b'X'):('shift f5',281), (b'\x00', b'Y'):('shift f6',282),
    (b'\x00', b'Z'):('shift f7',283), (b'\x00', b'['):('shift f8',284), 
    (b'\x00', b'\\'):('shift f9',285), (b'\x00', b']'):('shift f10',286), 
    (b'\xe0', b'\x87'):('shift f11',287), (b'\xe0', b'\x88'):('shift f12',288),
    
    # [insert] [delete]
    #(b'\xe0', b'R'):('<389>',389), #(b'\xe0', b'S'):('<381>',381),
    
    # [NUMBER] keys
    b'\xf8':('?',248), b'!':('!',33), b'"':('"',34),
    b'#':('#',35), b'$':('$',36), b'%':('%',37),
    b'&':('&',38), b'/':('/',47), b'(':('(',40),
    b')':(')',41), b'=':('=',61), b'?':('?',63),
    b'\xad':('\xad',173), 
    # b'\x08':('backspace',8), (b'\xe0', b'G'):('<388>',388), 
    
    # [q - p] keys 
    #b'\t':('<351>',351),
    b'Q':('Q',81), b'W':('W',87), b'E':('E',69),
    b'R':('R',82), b'T':('T',84), b'Y':('Y',89),
    b'U':('U',85), b'I':('I',73), b'O':('O',79),
    b'P':('P',80), b'*':('*',42), 
    #b'\r':('enter',13),
    
    # [a - l] keys
    b'A':('A',65), b'S':('S',83), b'D':('D',68),
    b'F':('F',70), b'G':('G',71), b'H':('H',72),
    b'J':('J',74), b'K':('K',75), b'L':('L',76),
    b'\xa5':('?',165), b'[':('[',91), b']':(']',93),
    
    # [z - m] keys
    b'>':('>',62), b'Z':('Z',90), b'X':('X',88),
    b'C':('C',67), b'V':('V',86), b'B':('B',66),
    b'N':('N',78), b'M':('M',77), b';':(';',59), 
    b':':(':',58), b'_':('_',95),
    
    # [up] [end]
    #(b'\xe0', b'H'):('<547>',547), (b'\xe0', b'O'):('<384>',384),
    
    # [space] [left]  [down] [right] 
    # b' ':(' ',32),
    #(b'\xe0', b'K'):('<391>',391),
    #(b'\xe0', b'P'):('<548>',548), (b'\xe0', b'M'):('<400>',400),
    
    #   / * - keys
    # 7 8 9  
    # 4 5 6
    # 1 2 3 
    # 0   . 
    (b'\x00', b'G'):('<449>',449), (b'\x00', b'H'):('<450>',450),
    (b'\x00', b'I'):('<451>',451), (b'\x00', b'K'):('<452>',452), 
    (b'\x00', b'M'):('<454>',454), (b'\x00', b'O'):('<455>',455), 
    #45:('<453>',453), 
    (b'\x00', b'P'):('<456>',456), (b'\x00', b'Q'):('<457>',457),
    (b'\x00', b'R'):('<506>',506), (b'\x00', b'S'):('<462>',462),
    # + enter
    # b'\r':('<530>',530),
    
    
                  
    # Third Group
    # [ctrl] + keypress
    
    # [FUNCTION] keys   
    (b'\x00', b'^'):('<289>',289), (b'\x00', b'_'):('<290>',290), 
    (b'\x00', b'`'):('<291>',291), (b'\x00', b'a'):('<292>',292), 
    (b'\x00', b'b'):('<293>',293), (b'\x00', b'c'):('<294>',294),
    (b'\x00', b'd'):('<295>',295), (b'\x00', b'e'):('<296>',296), 
    (b'\x00', b'f'):('<297>',297), (b'\x00', b'g'):('<298>',298), 
    (b'\xe0', b'\x89'):('<299>',299), (b'\xe0', b'\x8a'):('<300>',300),
    (b'\xe0', b'\x92'):('<477>',477), (b'\xe0', b'\x93'):('<527>',527),
    
    # [NUMBER] keys
    # 45:('ctrl \\',28), 45:('<0>',0), (b'\x00', b'\x03'):('<0>',0),
    # 45:('<0>',0), 45:('<0>',0), 45:('<0>',0),
    # 45:('<0>',0), 45:('<0>',0), 45:('<0>',0),
    # 45:('<0>',0), 45:('<0>',0), b'\x1c':('ctrl \\',28),
    # 45:('ctrl ]',29),
    
    # [ctrl tab]
    (b'\x00', b'\x94'):('ctrl tab',482), 
    
    # [q - p] keys 
    b'\x11':('ctrl q',17), b'\x17':('ctrl w',23),
    b'\x05':('ctrl e',5), b'\x12':('ctrl r',18), b'\x14':('ctrl t',20),
    b'\x19':('ctrl y',25), b'\x15':('ctrl u',21), #b'\t':('tab',9),
    b'\x0f':('ctrl o',15), b'\x10':('ctrl p',16), #45:('<0>',0),
    
    # [a - l] keys
    b'\x01':('ctrl a',1), b'\x13':('ctrl s',19), b'\x04':('ctrl d',4),
    b'\x06':('ctrl f',6), b'\x07':('ctrl g',7), #b'\x08':('backspace',8),
    b'\n':('<529>',529), b'\x0b':('ctrl k',11), b'\x0c':('ctrl l',12),
    b'\x1d':('ctrl ]',29), # b'\x1b':('esc',27), 45:('<0>',0), 
    
    # [z - m] keys
    b'\x1a':('ctrl z',26), b'\x18':('ctrl x',24), b'\x03':('ctrl c',3),
    b'\x16':('ctrl v',22), b'\x02':('ctrl b',2), b'\x0e':('ctrl n',14),
    #b'\r':('enter',13), 45:('<0>',0), 45:('<0>',0),
    
    # [up] [end]
    (b'\xe0', b'\x8d'):('ctrl up',480), (b'\xe0', b'u'):('ctrl end',448),
    
    # [space] [left]  [down] [right] 
    #b' ':(' ',32),
    (b'\xe0', b's'):('ctrl left',443), (b'\xe0', b'\x91'):('ctrl down',481),
    (b'\xe0', b't'):('ctrl right',444),
    
    #   / * - keys
    (b'\x00', b'\x95'):('ctrl /',470), #45:('<471>',471), 45:('<469>',469),
    
    # + enter
    # 45:('<468>',468), b'\n':('<460>',460),
    
    # 7 8 9 
    # 4 5 6
    # 1 2 3 
    (b'\x00', b'w'):('<514>',514), (b'\x00', b'\x8d'):('<515>',515),
    (b'\x00', b'\x84'):('<516>',516), (b'\x00', b's'):('<511>',511),
    (b'\x00', b't'):('<513>',513), (b'\x00', b'u'):('<508>',508),
    #45:('<512>',512), 
    (b'\x00', b'\x91'):('<509>',509), (b'\x00', b'v'):('<510>',510),
    # 0 .
    (b'\x00', b'\x92'):('<507>',507), (b'\x00', b'\x93'):('<466>',466),
    
    
                  
    # Fourth Group
    # [alt] + keypress
    
    # [FUNCTION] keys   
    (b'\x00', b'h'):('meta f1',301), (b'\x00', b'i'):('meta f2',302), 
    (b'\x00', b'j'):('meta f3',303), (b'\x00', b'k'):('meta f4',304), 
    (b'\x00', b'l'):('meta f5',305), (b'\x00', b'm'):('meta f6',306),
    (b'\x00', b'n'):('meta f7',307), (b'\x00', b'o'):('meta f8',308), 
    (b'\x00', b'p'):('meta f9',309), (b'\x00', b'q'):('meta f10',310), 
    (b'\xe0', b'\x8b'):('meta f9',311), (b'\xe0', b'\x8c'):('meta f12',312),
    
    # [insert] [delete]
    (b'\x00', b'\xa2'):('meta insert',479), (b'\x00', b'\xa3'):('meta delete',478),
    
    # [NUMBER] keys
    # msvcrt dont catch well
    
    # [q - p] keys 
    # b'q':('<433>',433), b'w':('<439>',439), b'e':('<421>',421),
    # b'r':('<434>',434), b't':('<436>',436), b'y':('<441>',441),
    # b'u':('<437>',437), b'i':('<425>',425), b'o':('<431>',431),
    # b'p':('<432>',432), b'+':('<0>',0),
    
    # [a - l] keys
    # b'a':('<417>',417), b's':('<435>',435), b'd':('<420>',420),
    # b'f':('<422>',422), b'g':('<423>',423), b'h':('<424>',424),
    # b'j':('<426>',426), b'k':('<427>',427), b'l':('<428>',428),
    # b'{':('<500>',500), b'}':('<0>',0),
    
    # [z - m] keys
    # b'z':('<442>',442), b'x':('<440>',440), b'c':('<419>',419),
    # b'v':('<438>',438), b'b':('<418>',418), b'n':('<430>',430),
    # b'm':('<429>',429), #b',':('<0>',0), b'.':('<0>',0),
    
    # [alt -] [alt up] [alt end]
    #45:('<0>',0),
    (b'\x00', b'\x98'):('meta up',490), (b'\x00', b'\x9f'):('meta end',489), 
    
    # [left] [down] [right] 
    (b'\x00', b'\x9b'):('meta left',539), (b'\x00', b'\xa0'):('meta down',491),
    (b'\x00', b'\x9d'):('meta right',492),
    
    # 7 8 9  
    # 4 5 6
    # 1 2 3 
    # 45:('<524>',524), 45:('<525>',525), 45:('<526>',526),
    # 45:('<521>',521), 45:('<522>',522), 45:('<523>',523),
    # 45:('<518>',518), 45:('<519>',519), 45:('<520>',520),
    
    # 0 . 
    # 45:('<517>',517), b'.':('<476>',476),
    
    #   / * - keys
    # b'/':('<474>',474), b'*':('<475>',475), 45:('<473>',473),
    
    # + enter
    # b'+':('<472>',472),
}

def as_curses(key='',ignore=True):
    if ignore:
        try:
            return msvcrt_curses[key]
        except:
            return ([], [])
    else:
        return msvcrt_curses[key]
    